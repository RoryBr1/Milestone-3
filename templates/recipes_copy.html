{% extends "base.html" %}
{% block content %}

<div class="container">
    <div class="search-panel">
        <form action="{{ url_for('search') }}" method="post" class="col s12">
            <div class="row valign-wrapper center-align">
                <div class="input-field col s10">
                    <input type="text" name="query" id="query" minlength="3" class="search-input validate" required>
                    <label for="query">Search recipes</label>
                </div>
                <div class="col s2">
                    <button type="submit" class="light-blue darken-1 btn text-shadow search-button">
                        <i class="fas fa-search center-align center"></i>
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

{% if session.user|lower == "admin1"|lower %}
<div class="container">
    <div class="row">
        <div class="col s12">

            <div class="col s12 l4">
                <a href="{{ url_for('add_recipe') }}" class="btn orange accent-3 admin-panel-btn hvr-reveal"> <i
                        class="fas fa-plus-square"></i> Add New
                    Recipe</a>
            </div>
            <div class="col s12 l4">
                <a href="{{ url_for('show_categories') }}" class="btn orange darken-2 admin-panel-btn  hvr-reveal"><i
                        class="fas fa-folder"></i>
                    Manage Categories</a>
            </div>
            <div class="col s12 l4">
                <a href="{{ url_for('logout') }}" class="btn admin-panel-btn red lighten-2 hvr-reveal"><i
                        class="fas fa-sign-out-alt"></i> Logout as
                    {{ session.user }} </a>
            </div>
        </div>
    </div>
</div>
{% endif %}

{% if recipes|length > 0 %}
<div class="container">
    <div class="row">
        {% for recipe in recipes %}
        <div class="recipe-card col s6 left">
            <a href="{{ url_for('show_recipe', recipe_id=recipe._id) }}" class="grey-text text-darken-3">
                <img src="{{ recipe.img_url }}">
                <h5>{{ recipe.recipe_name }}</h5>

                <!-- Edit and Delete Buttons -->
                <div class="row">
                    <div class="col s6 right">
                        <button data-target="{{ recipe._id }}"
                            class="btn-small edit-delete-btn red lighten-2 hvr-reveal btn modal-trigger"
                            alt="Delete this recipe"><i class="fas fa-trash-alt"></i> <span
                                class="hide-on-small-only">Delete</span> </button>
                    </div>

                    <div class="col s6 right">
                        <a href="{{ url_for('add_recipe') }}"
                            class="btn-small edit-delete-btn indigo lighten-2 hvr-reveal" alt="Edit this recipe">
                            <i class="fas fa-edit"></i>
                            <span class="hide-on-small-only">Edit</span></a></div>
                </div>
                

                {% if session.user|lower == "admin1"|lower %}
                <!-- Delete confirmation modal -->
                <div id="{{ recipe._id }}" class="modal">
                    <div class="container">
                        <div class="modal-content">
                            <h5 class="center-align"><i class="fas fa-trash-alt grey-text text-lighten-1"></i>
                                Delete
                                "{{ recipe.recipe_name }}" ?</h5><br>
                            <p class="center">This action cannot be reversed.</p>
                        </div>
                        <div class="modal-footer">
                            <div class="row">
                                <div class="col s12">
                                    <a href="{{ url_for('delete_recipe', recipe_id=recipe._id, recipe_name=recipe.recipe_name) }}"
                                        data-target="{{ recipe._id }}"
                                        class="btn-small edit-delete-btn red lighten-2 hvr-reveal"><i
                                            class="fas fa-trash-alt"></i> Delete</a>
                                    <a href="#!" class="btn-small edit-delete-btn grey hvr-reveal modal-close"><i
                                            class="fas fa-times"></i> Cancel</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        {% endif %}
        {% endfor %}
    </div>
</div>
{% else %}

<!-- Shown when no results are found matching search query -->
<div class="container center valign-wrapper">
    <div class="row">
        <h5>No results found.</h5>
        <a href="{{ url_for('get_recipes') }}">Back to homepage.</a>
    </div>
</div>
{% endif %}
{% endblock %}